# JetRacer 技術仕様書

## 概要

JetRacerは、NVIDIA Jetson Nanoを搭載した小型自律走行車です。機械学習とコンピュータビジョンを活用し、障害物回避や自律走行を実現します。

## ハードウェア構成

### プラットフォーム
- ベース: NVIDIA Jetson Nano（4GB RAM）
- CPU: Quad-core ARM Cortex-A57
- GPU: 128-core NVIDIA Maxwell GPU
- 電源: 2セルLiPoバッテリー（7.4V）

### センサー類
- **超音波センサー（3個）**
  - 前方センサー: HC-SR04（測定範囲: 2cm - 400cm）
  - 左センサー: HC-SR04（測定範囲: 2cm - 400cm）
  - 右センサー: HC-SR04（測定範囲: 2cm - 400cm）
  - 精度: ±3mm
  - 測定周期: 約50ms

- **IMU（慣性計測装置）**
  - モデル: MPU6050
  - 3軸加速度センサー
  - 3軸ジャイロスコープ
  - サンプリングレート: 最大8kHz

- **カメラ**
  - 型番: IMX219 カメラモジュール
  - 解像度: 8MP（3280 x 2464）
  - フレームレート: 30fps @ 1080p
  - 視野角: 約160度

### アクチュエータ
- **DCモーター**
  - 駆動方式: 4WD（四輪駆動）
  - モータードライバ: TB6612FNG
  - 最大出力: 1.2A（連続）、3.2A（ピーク）

- **サーボモーター**
  - 型番: SG90
  - 動作角度: 0° - 180°
  - 制御方式: PWM信号
  - 応答速度: 0.1秒/60度

## ソフトウェア構成

### オペレーティングシステム
- Ubuntu 18.04 LTS（JetPack SDK付属）
- Python 3.6以上

### 主要ライブラリ
- **PyTorch**: 深層学習フレームワーク
- **OpenCV**: 画像処理
- **Adafruit_PCA9685**: サーボ制御
- **Jetson.GPIO**: GPIO制御

### 走行モード

#### 1. センサーオンリーモード（SENSOR_ONLY）
超音波センサーのみで障害物を回避。

**動作原理**:
- 前方センサーが50cm以下を検知 → 減速
- 前方センサーが30cm以下を検知 → 停止
- 左右センサーで障害物の位置を判断 → 回避方向決定

**利点**:
- 低負荷（CPU使用率: 約20%）
- 反応速度が速い（応答時間: 約100ms）

**欠点**:
- 複雑な環境では対応困難
- 視覚情報がない

#### 2. ビジョンモード（VISION）
カメラ画像を解析して走行。

**動作原理**:
- カメラ画像から車線を検出
- 深層学習モデルで操舵角を予測
- センサー情報も併用して安全性向上

**利点**:
- 複雑な環境に対応
- 人間の運転に近い挙動

**欠点**:
- 高負荷（CPU使用率: 約60%, GPU使用率: 約80%）
- 照明条件に影響される

#### 3. 完全自律モード（FULL_AUTONOMY）
センサー + ビジョンの統合制御。

**動作原理**:
- カメラで進路判断
- 超音波センサーで安全確認
- IMUで姿勢制御
- 複数の情報を統合して最適な制御を実行

## 制御パラメータ

### スロットル（速度）
- 範囲: -1.0 〜 +1.0
  - -1.0: 最大後退
  - 0.0: 停止
  - +1.0: 最大前進
- 推奨値: 0.3 - 0.7（安定走行）
- 最高速度: 約3.0 m/s（スロットル1.0時）

### ステアリング（操舵）
- 範囲: -1.0 〜 +1.0
  - -1.0: 最大右旋回
  - 0.0: 直進
  - +1.0: 最大左旋回
- 旋回半径: 約0.5m（最大舵角時）

### PIDパラメータ（速度制御）
- P（比例）ゲイン: 0.5
- I（積分）ゲイン: 0.1
- D（微分）ゲイン: 0.05

## 安全機能

### 緊急停止条件
1. 前方センサーが20cm以下を検知
2. バッテリー電圧が6.5V以下
3. IMUで異常な姿勢を検出（転倒など）
4. 通信断（2秒以上）

### フェールセーフ
- センサー故障時: センサーオンリーモードに自動切替
- カメラ故障時: ビジョンモード無効化
- バッテリー低下時: 低速モード（スロットル上限0.3）

## 性能指標

### 走行性能
- 最高速度: 3.0 m/s
- 最小旋回半径: 0.5 m
- 登坂能力: 約15度
- 連続走行時間: 約30分（通常走行時）

### 処理性能
- カメラフレーム処理: 30fps
- 深層学習推論速度: 約50ms/フレーム
- センサーサンプリング: 20Hz
- 制御ループ周期: 50Hz（20ms）

## トラブルシューティング

### よくある問題

**問題1: カメラ映像が表示されない**
- 原因: カメラケーブルの接続不良
- 解決: カメラケーブルを再接続、Jetson Nanoを再起動

**問題2: モーターが動かない**
- 原因: バッテリー電圧低下、またはモータードライバの過熱
- 解決: バッテリー充電、5分間冷却後に再起動

**問題3: 直進しない**
- 原因: 左右モーターの出力差、またはタイヤの摩耗
- 解決: trim値を調整（config.yamlのsteering_offset）

**問題4: センサー値が不安定**
- 原因: 配線のノイズ、または電源電圧の変動
- 解決: 配線を短くする、コンデンサで電源安定化

## メンテナンス

### 日常点検
- バッテリー電圧の確認（7.0V以上）
- タイヤの摩耗チェック
- センサー表面の清掃
- カメラレンズの汚れ確認

### 定期メンテナンス（100時間ごと）
- モーターブラシの点検
- ギアの摩耗確認
- ベアリングへの注油
- 配線の断線チェック

## 参考情報

### 公式リソース
- NVIDIA JetRacer Wiki: https://github.com/NVIDIA-AI-IOT/jetracer
- Jetson Nano 開発者ガイド: https://developer.nvidia.com/jetson-nano

### コミュニティ
- JetBot/JetRacer Forums
- NVIDIA Developer Forums

---
**ドキュメント作成日**: 2026年1月14日
**対象バージョン**: JetRacer v1.0
**duo-talk-simple プロジェクト用知識ベース**
