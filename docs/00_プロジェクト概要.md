# duo-talk-simple プロジェクト概要

## プロジェクトの目的

duo-talk-simpleは、easy-local-ragのシンプルさを継承しつつ、duo-talk（AI姉妹VTuberシステム）用に最適化された最小限のRAG（Retrieval-Augmented Generation）システムです。

### 背景

- duo-talkプロジェクトで複雑化した実装を一度リセット
- 確実に動作する基盤から再構築
- easy-local-rag (1.2k stars) の実績あるアプローチを参考に新規開発

### 目標

1. **シンプルさ**: 1日で理解できる構造（コア機能は3ファイルのみ）
2. **堅牢性**: エラー処理とリトライ機能の充実
3. **拡張性**: 将来の大規模改造を見据えたモジュール設計

---

## コアコンセプト

```
「easy-local-ragのシンプルさ」× 「duo-talkの拡張性」
```

### 3つの設計原則

#### 1. シンプルさの維持
- ファイル数を最小限に（全体で20ファイル未満）
- コア機能は3ファイルのみ
- 依存関係を最小化

#### 2. 拡張性の確保
- 設定ファイルで動作変更可能
- モジュール境界を明確に
- テスト可能な設計

#### 3. duo-talk固有の最適化
- 姉妹キャラクター（やな・あゆ）対応
- JetRacer知識に特化
- 会話品質重視

---

## システムの特徴

### easy-local-ragから継承する良さ

| 要素 | 説明 |
|------|------|
| **Ollama統合** | OpenAI互換APIによるシンプルな接続 |
| **検索方式** | コサイン類似度ベースの高速検索 |
| **会話履歴** | 文脈を保持した自然な対話 |
| **埋め込みモデル** | mxbai-embed-large（Ollama公式） |

### duo-talk用の改良点

| 要素 | 改良内容 |
|------|---------|
| **永続化** | ChromaDBによる埋め込みベクトル保存 |
| **メタデータ** | キャラクター別・ドメイン別検索 |
| **エラー処理** | リトライ機構とタイムアウト処理 |
| **設定外部化** | YAML形式で全設定を管理 |
| **テスト** | ユニットテスト・統合テストを完備 |

---

## 技術スタック

### コア技術

| 技術 | バージョン | 用途 |
|------|-----------|------|
| Python | 3.10+ | 実装言語 |
| Ollama | 最新版 | LLM実行環境 |
| Gemma 3 | 12B | 言語モデル |
| mxbai-embed-large | 最新版 | 埋め込みモデル |
| ChromaDB | 0.4.22+ | ベクトルDB |
| PyTorch | 2.0+ | テンソル演算 |

### 依存ライブラリ

- `ollama`: Ollama Python SDK
- `chromadb`: ベクトルデータベース
- `torch`: コサイン類似度計算
- `pyyaml`: 設定ファイル読み込み
- `openai`: OpenAI互換API用
- `pytest`: テストフレームワーク

---

## プロジェクト構成

```
duo-talk-simple/
├── docs/                    # 技術資料（このフォルダ）
├── knowledge/               # 知識ベース（テキスト）
├── personas/                # キャラクター設定
├── core/                    # コア機能（3ファイル）
│   ├── ollama_client.py    # Ollama接続層
│   ├── rag_engine.py       # RAG検索エンジン
│   └── character.py        # キャラクター応答
├── tests/                   # テストコード
├── data/                    # 実行時生成データ
├── config.yaml             # 全体設定
├── requirements.txt        # 依存関係
└── chat.py                 # メインエントリーポイント
```

**コアファイル数**: わずか3ファイル
**全体ファイル数**: 約15ファイル（テスト含む）

---

## 対象ユーザー

### 主な対象
- duo-talkプロジェクトの開発者（Tsuyoshiさん）
- 将来的にduo-talkをカスタマイズする開発者

### 前提知識
- Python基礎
- Ollamaの基本操作（モデルのpull、実行）
- RAGの基本概念（あれば望ましい）

---

## 開発環境

### 推奨環境

#### ハードウェア
- **GPU**: NVIDIA RTX A5000 (24GB VRAM) または RTX 2080 Super
- **RAM**: 16GB以上
- **ストレージ**: 20GB以上の空き容量

#### ソフトウェア
- **OS**: Ubuntu 22.04/24.04 または Windows 11 (WSL2)
- **Python**: 3.10以上
- **Ollama**: 最新版
- **CUDA**: 11.8以上（GPU使用時）

### 動作確認済み環境
- Ubuntu 24.04 + RTX A5000
- Windows 11 + WSL2 + RTX 2080 Super

---

## 成功基準

### Phase 2完了時の目標

#### 定量基準
| 項目 | 基準値 |
|------|--------|
| ファイル数 | < 20ファイル |
| コア機能 | 3ファイルのみ |
| 起動時間 | < 5秒（2回目以降） |
| 応答時間 | < 3秒（RAG検索+LLM生成） |
| VRAM使用量 | < 12GB（Gemma3-12B） |

#### 定性基準
- [ ] やなとあゆの口調が明確に違う
- [ ] JetRacer知識を正確に参照できる
- [ ] 5ターン以上の自然な会話が続く
- [ ] エラー時に落ちない（適切なメッセージ表示）
- [ ] 設定変更だけでモデル切り替え可能

---

## 制約事項

### 技術的制約
- Ollamaが必須（ローカルLLM実行環境）
- GPUがあることが望ましい（CPUでも動作するが遅い）
- 日本語対応が必須

### スコープ外
- マルチモーダル対応（画像・音声）
- リアルタイム音声入出力
- VTuberアバター連携
- 複数AIの同時対話

これらは将来のduo-talk本体で実装予定。

---

## ドキュメント構成

### 本フォルダ（docs/）の資料一覧

| ファイル名 | 内容 |
|-----------|------|
| 00_プロジェクト概要.md | 本ファイル - プロジェクト全体像 |
| 01_アーキテクチャ設計.md | システム構成とコンポーネント図 |
| 02_コンポーネント詳細.md | 各コンポーネントのAPI仕様 |
| 03_設定ファイル仕様.md | YAML設定ファイルの詳細 |
| 04_データフロー.md | 処理フローと状態遷移 |
| 05_実装計画.md | 段階的実装ガイドライン |
| 06_テスト戦略.md | テスト方針とテストケース |
| 99_easy-local-rag比較分析.md | 元リポジトリとの比較 |

### 読む順序（推奨）

1. **00_プロジェクト概要.md**（本ファイル） - 全体像を理解
2. **01_アーキテクチャ設計.md** - システム構成を把握
3. **02_コンポーネント詳細.md** - 実装詳細を理解
4. **05_実装計画.md** - 実装の進め方を確認

---

## クイックスタート（将来の実装後）

```bash
# 1. リポジトリクローン
git clone https://github.com/your-repo/duo-talk-simple.git
cd duo-talk-simple

# 2. 依存インストール
pip install -r requirements.txt

# 3. Ollamaモデル準備
ollama pull gemma3:12b
ollama pull mxbai-embed-large

# 4. 知識ベース投入（初回のみ）
# 自動でknowledge/内のテキストを読み込み

# 5. 実行
python chat.py
```

---

## ライセンス

MIT License

---

## 参考リポジトリ

- **easy-local-rag**: https://github.com/AllAboutAI-YT/easy-local-rag
  - 本プロジェクトの参考元（1.2k stars）
  - Ollama + RAGのシンプルな実装

- **duo-talk（本体）**: （非公開リポジトリ）
  - 本プロジェクトの最終統合先
  - AIVTuber姉妹システム

---

## 更新履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2026-01-14 | 0.1.0 | 初版作成 - プロジェクト設計開始 |

---

**作成日**: 2026年1月14日  
**最終更新**: 2026年1月14日  
**ステータス**: 設計フェーズ
